<!DOCTYPE html>
<html>
    <head>
        <title>Kendo UI and Backbone</title>
        <link href="http://cdn.kendostatic.com/2012.1.322/styles/kendo.common.min.css" rel="stylesheet" />
        <link href="http://cdn.kendostatic.com/2012.1.322/styles/kendo.default.min.css" rel="stylesheet" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://cdn.kendostatic.com/2012.1.322/js/kendo.web.min.js"></script>
        <script src="http://documentcloud.github.com/underscore/underscore-min.js"></script>
        <script src="http://backbonejs.org/backbone-min.js"></script>
        <script src="kendo.backbone.js"></script>
    </head>
    <body>
        <h3>Grid</h3>
        <div id="grid">
        </div>

        <h3>Backbone collection</h3>
        <pre id="log">
        </pre>

        <input id="setBackbone" type="button" value="Set Backbone" />
        <input id="setKendo" type="button" value="Set Kendo" /><br />
        <input id="popBackbone" type="button" value="Pop Backbone" />
        <input id="popKendo" type="button" value="Pop Kendo" /><br />
        <input id="pushBackbone" type="button" value="Push Backbone" />
        <input id="pushKendo" type="button" value="Push Kendo" /><br />

        <script>
                var Product = Backbone.Model.extend({
                });

                var ProductCollection = Backbone.Collection.extend({
                    model: Product
                });

                var products = new ProductCollection();

                var product = new Product();
                product.set("ProductID",1);
                product.set("Name","Food");
                products.push(product);

                product = new Product();
                product.set("ProductID",2);
                product.set("Name","Coffee");
                products.push(product);

                var ProductWrapper = kendo.backboneModel(Product, {
                    id: "ProductID",
                    fields: {
                        ProductID: { type: "number" },
                        Name: { type: "string" }
                    }
                });

                var ProductCollectionWrapper = kendo.backboneCollection(ProductWrapper);

                products.on("change remove add", function() {
                    $("#log").text(kendo.stringify(products.toJSON()));
                });

                $("#log").text(kendo.stringify(products.toJSON()));

                var wrappedProducts = new ProductCollectionWrapper(products);
                $("#grid").kendoGrid({
                    editable: {
                        mode: 'inline'
                    },
                    toolbar: ["create"],
                    columns: ["ProductID", "Name", { command: ["edit","destroy"] }],
                    dataSource: {
                        schema: {
                            model: ProductWrapper
                        },
                        data: wrappedProducts
                    }
                });

                $("#setBackbone")
                    .click(function(event) {
                        event.preventDefault();
                        products.at(0).set("Name", "setBackbone");
                    });

                $("#setKendo")
                    .click(function(event) {
                        event.preventDefault();
                        wrappedProducts[0].set("Name", "setKendo");
                    });

                $("#popBackbone")
                    .click(function(event) {
                        event.preventDefault();
                        products.pop();
                    });

                $("#popKendo")
                    .click(function(event) {
                        event.preventDefault();
                        wrappedProducts.pop();
                    });

                $("#pushBackbone")
                    .click(function(event) {
                        event.preventDefault();
                        var newProduct = new Product();
                        newProduct.set('ProductID', + (products.length+1));
                        newProduct.set('Name','Product #' + (products.length+1));
                        products.push(newProduct);
                    });

                $("#pushKendo")
                    .click(function(event) {
                        event.preventDefault();
                        wrappedProducts.push({
                            ProductID: (products.length+1),
                            Name: "Product #" + (products.length+1)
                        })
                    });
        </script>
    </body>
</html>
